{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="panel panel-primary">
    <div class="panel-body index-body">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7">
                
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active update" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Productores</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link update" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Organizaciones</a>
                  </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                  <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                      <div id="gmaps-markers" class="gmaps"></div>
                  </div>
                  <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                    <div id="gmaps-markers2" class="gmaps"></div>
                    </div>
                </div>

                <!--<ul class="leyenda">
                    <li>
                        <span> <img src="/static/nuevo/m2.png" height="52" width="53" alt=""></span>
                        Productores
                    </li>
                    <li>
                        <span> <img src="/static/nuevo/m1.png" height="52" width="53" alt=""></span>
                        Organizaciones
                    </li>

                </ul>-->

            </div>
            <div class="col-xs-12 col-sm412 col-md-5 col-lg-5">
                
                        <p>Rikolto (anteriormente conocida como VECO MA) es una ONG internacional con más de 40 años de experiencia en la transformación de cadenas de valor, el fortalecimiento de organizaciones de agricultores a pequeña escala y de actores de la cadena alimentaria en África, Asia, Europa, Centroamérica y Latino américa.</p>

                        <p>Rikolto implementa programas en 14 países de todo el mundo a través de ocho oficinas regionales. Somos una red unida de más de 160 colegas, dispuestos a compartir nuestra experticia, experiencias, y con deseos de inspirar a otros.</p>

                        <p>Alcanzamos anualmente a 80,000 familias o 134 organizaciones de agricultores con especialistas a nivel internacional y trabajamos en clusters multidisciplinarios en Food Smart Cities, Arroz, Café y Cacao.</p>

            </div>
        </div>
    </div>
</div>
<div class="row apps">
    <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">
        <div class="panel panel-primary">
            <div class="panel-body">
                <div class="row">
                    
                    <div class="col-sm-12 descripcion">
                        <div class="titulo-icon">
                            <img class="center-block apps-img" src="/static/nuevo/Productores.png" alt="">
                            <h4>Productores </h4>
                        </div>
                        <div class="texto">
                            Cacao fino y cafés especiales posicionados en mercados nichos a través de Modelos de Negocios Inclusivos con perspectiva de género y jóvenes.
                        </div>
                    </div>
                </div>
                <div class="row btn-apps">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <a href="/productores/dashboard/?pais=1" class="btn btn-primary waves-effect waves-light">Dashboard</a>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <a href="/productores/" class="btn btn-primary waves-effect waves-light pull-right">Consulta</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">
        <div class="panel panel-primary">
            <div class="panel-body">
                <div class="row">
                    
                    <div class="col-sm-12 descripcion">
                        <div class=" titulo-icon">
                            <img class="center-block apps-img" src="/static/nuevo/Organización.png" alt="">
                            <h4>Organización  </h4>
                        </div>
                        <div class="texto">
                            Pequeños productores incrementan el volumen, calidad e inocuidad de sus productores ofertados a los mercados incluisivos en los rubros de hortaliza, cacao y café.
                        </div>
                    </div>
                </div>
                <div class="row btn-apps">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <a href="/organizaciones/dashboard/?pais=1" class="btn btn-primary waves-effect waves-light">Dashboard</a>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <a href="/organizaciones/" class="btn btn-primary waves-effect waves-light pull-right">Consulta</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">
        <div class="panel panel-primary">
            <div class="panel-body">
                <div class="row">
                    
                    <div class="col-sm-12 descripcion">
                        <div class=" titulo-icon">
                            <img class="" src="/static/nuevo/Subsectores.png" alt="">
                            <h4>Subsectores  </h4>
                        </div>

                        <div class="texto">
                            Actores de hortaliza, cacao y café alinean sus politicas y estrategias hacia la sostenibilidad e inclusiva.
                        </div>
                    </div>
                </div>
                <div class="row btn-apps">
                    <div class="col-sm-12">
                        <a href="/subsectores/" class="btn btn-primary waves-effect waves-light">Lista de proyectos</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">
        <div class="panel panel-primary">
            <div class="panel-body">
                <div class="row">
                    
                    <div class="col-sm-12 descripcion">
                        <div class=" titulo-icon">
                            <img class="center-block apps-img" src="/static/nuevo/report.png" alt="">
                            <h4>Reportes y Programas </h4>
                        </div>
                        <div class="texto">
                            Archivos disponibles para descarga en PDF.
                        </div>
                    </div>
                </div>
                <div class="row btn-apps">
                    <div class="col-sm-12">
                        <a href="/reportes/" class="btn btn-primary waves-effect waves-light">Lista de reportes</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBN8m5qDWE3cAMgBegvbkZQ7eHrG-Hu1oI"
  type="text/javascript"></script>

<script type="text/javascript" src="/static/js/markerclusterer.js"></script>
<script>


    var markers = [];
    function initialize()
    {
        var infowindow = new google.maps.InfoWindow();
        var myLatlng = new google.maps.LatLng(13.6477817,-85.543151);
        var myOptions = {
            zoom: 5,
            center: myLatlng,
        }

        var map = new google.maps.Map(document.getElementById('gmaps-markers'), myOptions);
        var bounds = new google.maps.LatLngBounds();
        var infowindow = new google.maps.InfoWindow();


        $.getJSON("{% url 'obtener-lista' %}", function(data){
            $.each(data, function(i, elemento){
                var latlng = new google.maps.LatLng(elemento.lat, elemento.lon);
                bounds.extend(latlng);
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: elemento.nombre,
                    // icon: image,
                    item: '',
                    id: elemento.id
                });
                markers.push(marker);

                // google.maps.event.addListener(marker, 'click', (function(mm, tt) {
                //     return function() {
                //         infowindow.setContent(tt);
                //         infowindow.open(map, mm);
                //     }
                // })(marker, elemento.nombre));

            });
            var markerCluster = new MarkerClusterer(map, markers);

        });

        // map.fitBounds(bounds);
    }

    var markers2 = [];
    function initialize2()
    {
        var infowindow = new google.maps.InfoWindow();
        var myLatlng = new google.maps.LatLng(13.6477817,-85.543151);
        var myOptions = {
            zoom: 5,
            center: myLatlng,
        }

        var map = new google.maps.Map(document.getElementById('gmaps-markers2'), myOptions);
        var bounds = new google.maps.LatLngBounds();
        var infowindow = new google.maps.InfoWindow();


        $.getJSON("{% url 'obtener-lista-org' %}", function(data){
            $.each(data, function(i, elemento){
                var latlng = new google.maps.LatLng(elemento.lat, elemento.lon);
                bounds.extend(latlng);
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: elemento.nombre,
                    // icon: image,
                    item: '',
                    id: elemento.id
                });
                markers2.push(marker);

                // google.maps.event.addListener(marker, 'click', (function(mm, tt) {
                //     return function() {
                //         infowindow.setContent(tt);
                //         infowindow.open(map, mm);
                //     }
                // })(marker, elemento.nombre));

            });
            var markerCluster = new MarkerClusterer(map, markers2);

        });

        // map.fitBounds(bounds);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
    google.maps.event.addDomListener(window, 'load', initialize2);

$('.update').on('shown.bs.tab', function(e) {
  google.maps.event.trigger(gmaps, 'resize');
  // map_{{year}}.setCenter(latlng);
});

 $(function () {
    $('#myTab #home-tab').tab('show')
  })
</script>
{% endblock %}
